<% content_for :head do %>
  <%= stylesheet_link_tag "views/_worldwide-organisation", media: "all" %>
<% end %>

<%= render partial: "worldwide_organisation/header", locals: { worldwide_organisation: @presenter, show_header_title: true } %>

<section class="govuk-grid-row" id="about-us">
  <div class="govuk-grid-column-two-thirds">
    <%= render "govuk_publishing_components/components/lead_paragraph", text: @content_item.description %>
    <%= render "govuk_publishing_components/components/govspeak", {} do
      raw(@content_item.body)
    end %>
  </div>

  <% if @presenter.social_media_accounts.any? %>
    <aside class="govuk-grid-column-one-third">
      <h2 class="govuk-heading-s"><%= t("worldwide_organisation.headings.follow_us") %></h2>
      <%= render "govuk_publishing_components/components/share_links", {
        track_as_follow: true,
        links: @presenter.social_media_accounts.map do |account|
          {
            href: account["href"],
            text: account["title"],
            icon: account["service_type"],
          }
        end,
        margin_bottom: 8,
      } %>
    </aside>
  <% end %>
</section>

<% if @presenter.show_our_people_section? %>
  <section id="people">
    <%= render "govuk_publishing_components/components/heading", {
      text: t("worldwide_organisation.headings.our_people"),
      border_top: 5,
      padding: true,
    } %>
    <div class="govuk-grid-row">
      <% if @presenter.person_in_primary_role %>
        <div class="govuk-grid-column-one-quarter">
          <%= render "govuk_publishing_components/components/image_card", {
            href: @presenter.person_in_primary_role[:href],
            image_src: @presenter.person_in_primary_role[:image_url],
            image_alt: @presenter.person_in_primary_role[:image_alt],
            heading_text: @presenter.person_in_primary_role[:name],
            heading_level: 3,
            description: @presenter.person_in_primary_role[:description],
          } %>
        </div>
      <% end %>

      <% unless @presenter.people_in_non_primary_roles.empty? %>
        <div class="govuk-grid-column-three-quarters">
          <ul class="govuk-list govuk-grid-row">
            <% @presenter.people_in_non_primary_roles.each.with_index do |person, i| %>
              <% extra_class = (i + 1) % 4 == 0 ? " clear-column" : "" %>
              <li class="govuk-grid-column-one-third<%= extra_class %>">
                <%= render "govuk_publishing_components/components/image_card", {
                  href: person[:href],
                  heading_text: person[:name],
                  heading_level: 3,
                  description: person[:description],
                } %>
              <% end %>
            </li>
          </ul>
        </div>
      <% end %>
    </div>
  </section>
<% end %>

<% if @presenter.main_office %>
  <section id="contact-us">
    <%= render "govuk_publishing_components/components/heading", {
      text: t("worldwide_organisation.headings.contact_us"),
      border_top: 5,
      padding: true,
    } %>

    <hr class="govuk-section-break govuk-section-break--visible">

    <div class="govuk-!-padding-top-6 govuk-!-padding-bottom-6 govuk-clearfix">
      <%= render partial: "worldwide_organisation/contact", locals: {
        contact: @presenter.main_office.contact,
      } %>

      <% if @presenter.main_office.has_access_and_opening_times? %>
        <p class="govuk-body"><%= link_to t("contact.access_and_opening_times"), @presenter.main_office.public_url, class: "govuk-link", lang: @content_item.locale %></p>
      <% end %>
    </div>

    <% @presenter.home_page_offices.each do |office| %>
      <hr class="govuk-section-break govuk-section-break--visible">

      <div class="govuk-!-padding-top-6 govuk-!-padding-bottom-6 govuk-clearfix">
        <%= render partial: "worldwide_organisation/contact", locals: {
          contact: office.contact,
        } %>

        <% if office.has_access_and_opening_times? %>
          <%= link_to t("contact.access_and_opening_times"), office.public_url, class: "govuk-link", lang: @content_item.locale %>
        <% end %>
      </div>
    <% end %>
  </section>
<% end %>

<% if @presenter.show_corporate_info_section? %>
  <section class="corporate-information" id="corporate-info">
    <%= render "govuk_publishing_components/components/heading", {
      text: t("worldwide_organisation.headings.corporate_information"),
      border_top: 5,
      padding: true,
    } %>

    <% if @presenter.corporate_information_pages.present? %>
      <%= render "govuk_publishing_components/components/list", {
        visible_counters: true,
        items: @presenter.corporate_information_pages,
      } %>
    <% end %>

    <% if @presenter.secondary_corporate_information.present? %>
      <p class="govuk-body">
        <%= @presenter.secondary_corporate_information.html_safe %>
      </p>
    <% end %>
  </section>
<% end %>
