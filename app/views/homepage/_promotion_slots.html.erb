<%
  # Before updating a promotion slot please read the documentation.
  # See: https://docs.publishing.service.gov.uk/repos/frontend/update-homepage-promotion-slots.html
%>

<%= content_tag(
    :section,
    class: "homepage-section homepage-section--promotion-slots",
    data: {
    module: "ga4-link-tracker",
    ga4_track_links_only: "",
    ga4_set_indexes: "",
    ga4_link: {
      event_name: "navigation",
      type: "homepage",
      index_section: locals[:index_section],
      index_section_count: locals[:index_section_count],
      section: t("homepage.index.featured", locale: :en),
    },
  },
  ) do %>
  <div class="homepage-section__heading">
    <div class="homepage-section__heading-wrapper">
      <%= render "govuk_publishing_components/components/heading", {
        text: t("homepage.index.featured"),
        font_size: "l",
        margin_bottom: 6,
      } %>
    </div>
  </div>

  <% t("homepage.index.promotion_slots").each do | item | %>
    <%= render "govuk_publishing_components/components/image_card", {
      href: item[:href],
      image_src: image_path(item[:image_src]),
      image_alt: "",
      image_loading: "lazy",
      heading_level: 3,
      heading_text: item[:title],
      two_thirds: true,
      large_font_size_mobile: true,
      description: item[:text],
      font_size: "s",
      srcset: item.fetch(:srcset, {}).stringify_keys.transform_keys { |k| image_path(k) }.presence,
    } %>
  <% end %>

  <% if I18n.exists?("homepage.index.promotion_slots_secondary") %>
    <div class="app-promo">
      <% t("homepage.index.promotion_slots_secondary").each do | item | %>
        <%= render "govuk_publishing_components/components/image_card", {
          href: item[:href],
          image_src: image_path(item[:image_src]),
          image_alt: "",
          image_loading: "lazy",
          heading_level: 3,
          heading_text: item[:title],
          two_thirds: true,
          large_font_size_mobile: true,
          description: item[:text],
          font_size: "s",
          srcset: item.fetch(:srcset, {}).stringify_keys.transform_keys { |k| image_path(k) }.presence,
        } %>
      <% end %>
    </div>
  <% end %>
<% end %>
