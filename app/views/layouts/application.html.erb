<% stylesheet_link_tag "application", media: "all"  # Trigger this without rendering it to ensure it appears in links header %>
<% emergency_banner = render("govuk_web_banners/emergency_banner") %>
<% global_banner = render("govuk_web_banners/global_banner") %>
<% content_for :body do %>
  <%= yield :before_content %>
  <div class="govuk-width-container">
    <% if content_item&.phase == "beta" %>
      <%= render "govuk_publishing_components/components/phase_banner", phase: "beta" %>
    <% end %>
    <% if show_breadcrumbs?(content_item) %>
      <%= render "govuk_publishing_components/components/contextual_breadcrumbs", content_item: content_item.to_h %>
    <% end %>
    <main role="main" id="content" class="govuk-main-wrapper <%= yield :main_classes %>" <%= lang_attribute %>>
      <span id="Top"></span>
      <%= yield %>
    </main>
  </div>
  <%= yield :after_content %>
<% end %>
<%= content_for :head do %>
  <%= csp_meta_tag %>
  <link title="Search" rel="search" type="application/opensearchdescription+xml" href="/search/opensearch.xml">
  <%= javascript_include_tag "test-dependencies.js", type: "module" if Rails.env.test? %>
  <%= yield :extra_javascript %>
  <%= render_component_stylesheets %>
  <% if content_item.to_h %>
    <%= render "govuk_publishing_components/components/meta_tags", content_item: content_item.to_h %>
    <% if content_item&.meta_section.present? %>
      <meta name="govuk:section" content="<%= content_item.meta_section %>">
    <% end %>
  <% end %>
<% end %>
<%
  page_title = yield :title
  page_title = page_title.presence || page_title(content_item) || "GOV.UK"
%>
<%= render "govuk_publishing_components/components/layout_for_public", {
    title: page_title,
    emergency_banner:,
    global_banner:,
  } do %>
  <%= yield :body %>
<% end %>
