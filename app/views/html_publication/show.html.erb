<% content_for :head do %>
  <%= render "govuk_publishing_components/components/machine_readable_metadata",
    schema: :html_publication,
    content_item: content_item.to_h %>

  <% if @presenter.hide_from_search_engines? %>
    <meta name="robots" content="noindex">
  <% end %>
  <%= stylesheet_link_tag "views/_html-publication" %>
  <%= stylesheet_link_tag "views/_csv_preview" %>
<% end %>

<% content_for :main_classes, "html-publication" %>

<% if content_item.organisations %>
  <div class="publication-external">
    <ul class="organisation-logos">
      <% @presenter.organisation_logos.each do |organisation| %>
        <li class="organisation-logos__logo">
          <%= render "govuk_publishing_components/components/organisation_logo", {
            organisation:,
          } %>
        </li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= render "govuk_publishing_components/components/inverse_header", {
  padding_top: 6,
  padding_bottom: 6,
  subtext: @presenter.last_changed,
} do %>
  <%= render "govuk_publishing_components/components/heading", {
    text: content_item.title,
    context: I18n.t("formats.#{@presenter.format_sub_type}.name", count: 1),
    inverse: true,
    margin_bottom: 0,
    font_size: "xl",
    heading_level: 1,
  } %>
<% end %>

<%= render "shared/history_notice", content_item: content_item %>

<% if content_item.withdrawn? %>
  <% withdrawn_time_tag = tag.time(display_date(content_item.withdrawn_at), datetime: content_item.withdrawn_at) %>

  <%= render "govuk_publishing_components/components/notice", {
    title: I18n.t("withdrawn_notice.title", schema_name: I18n.t("formats.#{@presenter.format_sub_type}.name", count: 1, locale: :en).downcase, withdrawn_time: withdrawn_time_tag).html_safe,
    description_govspeak: content_item.withdrawn_explanation&.html_safe,
    time: withdrawn_time_tag,
    lang: "en",
  } %>
<% end %>

<% if content_item.national_applicability.present? %>
  <%= render "govuk_publishing_components/components/devolved_nations", {
    national_applicability: content_item.national_applicability,
    content_type: content_item.schema_name,
  } %>
<% end %>

<div id="contents">
  <div class="govuk-grid-row gem-print-columns-none">
    <% if content_item.headers.any? %>
      <div class="govuk-grid-column-one-quarter-from-desktop contents-list-container">
        <%= render "govuk_publishing_components/components/contents_list", contents: @presenter.headers_for_contents_list_component, format_numbers: true %>

        <%= render "govuk_publishing_components/components/print_link", {
          margin_bottom: 6,
        } %>
      </div>
    <% end %>

    <div class="print-metadata">
      <%= render partial: "print_meta_data" %>
    </div>

    <div class="govuk-grid-column-three-quarters-from-desktop contents-container<% unless content_item.headers.any? %> offset-empty-contents-list<% end %>">
      <%= render "govuk_publishing_components/components/govspeak_html_publication", {
        direction: page_text_direction,
      } do %>
        <%= raw(content_item.body.html_safe) %>
      <% end %>
    </div>
  </div>

  <div class="govuk-grid-row">
    <%= render "govuk_publishing_components/components/back_to_top_link", href: "#contents", text: "Back to top" %>
  </div>
</div>
